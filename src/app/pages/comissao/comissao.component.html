<div >
    <div class="flex justify-between items-end mb-2 bg-transparent">
        <p-breadcrumb class="max-w-full" [model]="[{label:'Início', routerLink: '/'},{label:'Comissões'}]" />
        <p-button label="Adicionar" icon="fa-solid fa-plus" iconPos="left" [routerLink]="'/comissao/adicionar'" />
    </div>
    
    <p-card>
        <div class="flex flex-wrap gap-4 mb-6 items-end">
            <div class="flex-auto">
                <label for="filtro" class="font-bold block mb-2">Filtro</label>
                <input id="filtro" type="text" pInputText class="w-full" placeholder="Nome da comissão" [(ngModel)]="formFiltro.filtro" (keydown.enter)="filtrarLista()" />
            </div>   
            
            <div class="flex-none flex gap-2">
                <p-button label="Filtrar" icon="pi pi-search" (onClick)="filtrarLista()"  />
            </div>
        </div>

        <p-table 
            [value]="comissoes" 
            stripedRows 
            [responsive]="true"
            [paginator]="true" 
            [rows]="rows"
            [totalRecords]="totalRecords"
            [lazy]="true"
            (onPage)="loadComissoes($event)"
           >
            
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="nome">Nome <p-sortIcon field="nome" /></th>
                    <th pSortableColumn="ativa">Ativa <p-sortIcon field="ativa" /></th>
                    <th pSortableColumn="data_inicio_formatada">Data Início <p-sortIcon field="data_inicio_formatada" /></th>
                    <th pSortableColumn="data_fim_formatada">Data Fim <p-sortIcon field="data_fim_formatada" /></th>
                    <th pSortableColumn="dt_cadastro_formatada">Data de Cadastro <p-sortIcon field="dt_cadastro_formatada" /></th>
                    <th class="flex justify-end">Opções</th>
                </tr>
            </ng-template>
            
            <ng-template pTemplate="body" let-comissao>
                <tr>
                    <td>{{ comissao.nome }}</td>
                    <td><p-badge [value]="comissao.ativa? 'Sim' : 'Não'" [severity]="comissao.ativa?'success':'danger'" /></td>
                    <td>{{ comissao.data_inicio_formatada }}</td>
                    <td>{{ comissao.data_fim_formatada }}</td>
                    <td>{{ comissao.dt_cadastro_formatada }}</td>
                    <td class="flex justify-end" >
                        <p-button icon="fa-solid fa-pen" [rounded]="true" [text]="true" severity="primary" pTooltip="Editar" tooltipPosition="top" (click)="router.navigate(['/comissao/editar/' + comissao.id])" />
                        <p-button icon="fa-solid fa-trash" [rounded]="true" [text]="true" severity="danger"  pTooltip="Deletar" tooltipPosition="top" (click)="deleteComissao($event, comissao.id)" />
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="6" class="text-center">Nenhuma comissão encontrada.</td>
                </tr>
            </ng-template>
        </p-table>
    
        <p-confirmdialog />
        <p-toast />
    
    </p-card>
</div>
